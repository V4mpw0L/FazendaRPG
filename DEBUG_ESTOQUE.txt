â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘           ğŸ” DEBUG DO ESTOQUE - Passo a Passo                       â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

TESTE COMPLETO COM LOGS:
========================

1. Abra o jogo
2. Abra o Console (F12)
3. VÃ¡ para NPCs > Fazendeiro JosÃ© > Loja

LOGS ESPERADOS NO CONSOLE:
---------------------------
âš ï¸ Loaded JSON data - stock values will be REPLACED by saved data
ğŸ†• First time init: wheat_seed for old_farmer = 100/100
ğŸ†• First time init: corn_seed for old_farmer = 100/100
... (outros itens)
âœ… Total initialized: 11 new items
ğŸ’¾ Saved stock for 11 items to player data
ğŸ“¦ Current stock data: { ... }
âœ… Forced player.save() called
âœ… Player data loaded - JSON stock values IGNORED

4. Compre 50 sementes de trigo

LOGS ESPERADOS:
---------------
ğŸ›’ BUYING: 50x wheat_seed
ğŸ“Š Stock change: 100 â†’ 50
ğŸ’¾ Saved to player.data.npcStock[old_farmer][wheat_seed] = 50
ğŸ’¾ Saved stock for 11 items to player data
ğŸ“¦ Current stock data: {
  "old_farmer": {
    "wheat_seed": 50,
    "corn_seed": 100,
    ...
  }
}
âœ… Forced player.save() called
âœ… Verification: Stock saved as 50

5. Feche a loja
6. Pressione F5 para recarregar

LOGS ESPERADOS NO RELOAD:
--------------------------
âš ï¸ Loaded JSON data - stock values will be REPLACED by saved data
ğŸ”„ Restored 0x wheat_seed for old_farmer (50/100)  â† IMPORTANTE!
âœ… Total restored: 0 items
ğŸ’¾ Saved stock for 11 items to player data
ğŸ“¦ Current stock data: {
  "old_farmer": {
    "wheat_seed": 50,    â† DEVE SER 50, NÃƒO 100!
    ...
  }
}
âœ… Forced player.save() called
âœ… Player data loaded - JSON stock values IGNORED

7. Entre na loja novamente

RESULTADO ESPERADO:
-------------------
âœ… Estoque DEVE estar em 50
âœ… NÃƒO pode estar em 100!

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

SE O ESTOQUE VOLTA PARA 100:
=============================

1. Verifique os logs no console
2. Procure por estas mensagens:

âŒ PROBLEMA: Se aparecer "First time init" no reload
   â†’ Significa que os dados NÃƒO foram salvos
   
âœ… CORRETO: Deve aparecer "Restored 0x" ou valor > 0
   â†’ Significa que encontrou dados salvos

3. Teste manualmente no console:

// Ver dados salvos:
console.log(game.player.data.npcStock);

// Deve mostrar algo como:
{
  "old_farmer": {
    "wheat_seed": 50,
    "corn_seed": 100,
    ...
  }
}

// Se mostrar objeto vazio {} ou undefined:
â†’ O save NÃƒO estÃ¡ funcionando!

4. Teste o save manualmente:

// ForÃ§ar save:
game.player.data.npcStock = {
  "old_farmer": {
    "wheat_seed": 50
  }
};
game.player.save();

// Recarregar pÃ¡gina (F5)
// Verificar se manteve:
console.log(game.player.data.npcStock);

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

COMANDOS ÃšTEIS PARA DEBUG:
===========================

// Ver todos os dados do player:
console.log(game.player.data);

// Ver especificamente o estoque:
console.log("Stock:", game.player.data.npcStock);
console.log("Timestamps:", game.player.data.npcStockTimestamp);

// Ver o que estÃ¡ no localStorage:
console.log("LocalStorage:", localStorage.getItem('fazendarpg_save'));

// Limpar dados (CUIDADO - apaga tudo):
localStorage.clear();

// Setar estoque manualmente para teste:
game.player.data.npcStock.old_farmer.wheat_seed = 42;
game.player.save();

// ForÃ§ar reload do estoque:
game.npcsUI.loadNPCStock();

// Ver valor atual no objeto NPC:
console.log(game.npcsUI.npcsData.old_farmer.shop.items[0].stock);

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

POSSÃVEIS CAUSAS SE AINDA NÃƒO FUNCIONAR:
=========================================

1. Player.save() nÃ£o estÃ¡ salvando no localStorage
   â†’ Verificar se tem erros no console
   â†’ Verificar se localStorage estÃ¡ habilitado

2. Dados sendo carregados antes do init completar
   â†’ Problema de async/await

3. Outro cÃ³digo sobrescrevendo os dados
   â†’ Verificar se tem outros lugares que mexem com npcStock

4. localStorage cheio ou bloqueado
   â†’ Verificar quota do navegador

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ME ENVIE:
=========

Se ainda nÃ£o funcionar, me envie print/cÃ³pia dos logs do console:

1. Logs ao carregar o jogo (primeira vez)
2. Logs ao comprar itens
3. Logs ao recarregar (F5)
4. Output de: console.log(game.player.data.npcStock)

Com isso eu consigo identificar exatamente onde estÃ¡ o problema!

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
